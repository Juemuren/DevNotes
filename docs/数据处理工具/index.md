# 数据处理工具

## 基本概念

数据处理是这个信息时代中的一项重要活动。对于开发者而言，有必要认识一些常见的数据格式，并学会使用工具进行数据处理。

相比于二进制数据，本文更关注文本数据。因此之后介绍的数据格式和相关工具都主要和文本数据有关。

## 格式

### JSON

JSON 全称为 `JavaScript 对象表示法`。顾名思义，JavaScript 就使用这种格式表示对象，因此 JavaScript 序列化和反序列化 JSON 都非常方便。

JSON 经常会在和 JavaScript 有关的场合被用到，比如通过 HTTP 传输的数据、VSCode 的配置文件等。

### CSV

CSV 全称为 `逗号分隔值`。顾名思义，CSV 通过逗号隔开每个值，很适合存储像表格这样的数据。

CSV 在电子表格、数据库导入/导出、数据科学等领域中很常见。

### YAML

YAML 很类似 JSON，但为了便于人类读写而做了很多优化，比如使用缩进来表示层次结构、字段名和字符串可以省略引号、原生支持注释等。

YAML 常被用于配置文件，比如 Docker/Kubernetes/GitHub Actions 等都选择了 YAML。

### TOML

TOML 算是 INI 的升级版，同样使用键值对并支持分节，不过 TOML 还允许嵌套的组织结构。

TOML 被一些新兴语言用作项目配置文件，比如 Rust 和 Julia。TOML 现在随着新兴工具的流行而越来越常见，Python 社区也逐渐接受了使用 TOML 作为项目配置文件。

### XML

XML 全称为 `可拓展标记语言`，使用标签来组织数据和结构，并且标签可以嵌套和附加属性。

XML 早期在 Web 领域很流行，以至于 HTML 也选择了类似 XML 的语法，不过目前已几乎被 JSON 取代。另外 XML 还被很多软件选为内部格式，比如 Microsoft Office 的那些文档（包括 docx/xlsx/pptx）解压后其实就是一些包含了 XML 的文件、VLC 的皮肤文件解压后也包含了 XML 文件、SimulIDE 的电路图实际保存为一个 XML 文件。

## 工具

### 文本处理

文本处理工具主要用于没有特定格式的文本数据。

> [!Note]+ Linux 文本处理工具
> 多数 Linux 系统都预装了一大堆用于文本处理的工具，比如
>
> - 通用处理 `awk`
> - 编辑 `sed`
> - 查找 `grep`
> - 截取 `cut`/`head`/`tail`
> - 合并 `paste`/`join`
> - 拆分 `split`/`csplit`
> - 排序 `sort`
> - 去重 `uniq`
> - 统计 `wc`
> - 替换 `tr`
> - 比较 `comm`/`diff`
> - 格式化 `nl`/`column`
> - 随机化 `shuf`
> - 编码转换 `iconv`/`base64`
>
> 尽管本文不详细介绍这些工具，但它们同样是非常有用的，并且启发了很多新工具。

- [fzf](Fzf.md) 模糊查找器，可以看作一个交互式的 grep。fzf 提供了 shell 集成方法，能够显著改善终端的使用体验
- [ripgrep](Ripgrep.md) 文本查找器，类似 grep 但更现代
- sd 文本查找替换器，类似 sed 但更现代
- [delta](Delta.md) 对 git/diff 等命令的输出进行语法高亮和分页，方便查看
- jc 把很多常用命令的输出转为 JSON 格式，方便后续处理

### 格式处理

格式处理工具主要用于具有特定格式的文本数据。由于数据具有格式，因此这些工具通常会包含更多的功能，比如验证/转换格式、查询/替换特定字段的值等。

#### 代码格式

代码存在语法，因此也可以看成一种文本格式。虽说代码算不算数据可能有点争议，但我还是决定把它们归类为数据处理工具

- ast-grep 代码检索和修改工具，其搜索方式类似 grep，但匹配 `AST`（抽象语法树）而非文本，因此能够更安全地进行重构
- [bat](Bat.md) 显示文件内容，类似 cat 但更现代。支持语法高亮、显示行号等功能
- chroma 语法高亮器，可对输入进行语法高亮，支持非常多的语言
- [cloc](Cloc.md) 统计代码行数，类似的工具还有 `tokei`

#### 专一格式

只能处理一种格式**命令行工具**

- jq 命令行 JSON 处理器
- jid 基于 jq 的交互式 JSON 处理器
- yq 命令行 YAML 处理器
- qsv 命令行 CSV 处理器
- taplo 命令行 TOML 处理器
- xmlstarlet 命令行 XML 处理器

为一种格式提供了语言服务的 **VSCode 拓展**

- Rainbow CSV 提供了 CSV 的语言服务
- Even Better TOML 提供了 TOML 的语言服务
- YAML 提供了 YAML 的语言服务
- XML 提供了 XML 的语言服务

#### 通用格式

可以处理多种格式

- dsq 用 SQL 对各种格式的数据进行处理。dsq 基于 SQLite，目前已经停止更新了。也可以试试 DuckDB 或直接使用 SQLite
- miller 可以处理多种格式的数据，不过更适合表格型数据
- dasel 类似前者，不过更适合嵌套型数据
