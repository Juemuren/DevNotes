# 文档处理

## 格式

### Docx

我本人非常讨厌 docx 格式，原因非常多，我只列举部分好了

- 不通用，兼容性差。由于 docx 将数据以特殊的二进制形式存储，导致文件必须使用特定的软件来才能进行编辑和查看。我相信大部分人都遇到过自己的保存的 docx 文件在别人的电脑里打不开的情况
- 版本控制不友好。这又是因为 docx 以二进制存储数据。在 git 里，你没有办法通过 diff 查看每次提交间的差异；且 git 对于二进制文件的更改，不是只记录差异，而是记录整个文件，这会让 git 的提交记录变得非常庞大
- 没有强制的规范。这条比较主观，也许没有强制规范不是缺点，但因为太多人根本就不会使用 docx，所以我认为这成了缺点。比如，对于样式的更改，很多人只是选中几个字然后手动调整，不懂得应该先创建一个新的样式，然后再将选中的文字改成自定义样式。Microsoft Word 极低的使用门槛、过于灵活的样式导致市面上存在大量的低质文档，修改、维护都非常麻烦。我已经被学校发来的劣质文档恶心过无数次了

因此，我拿到 docx 文件后通常会将其[转为 markdown 或 pdf 格式](Pandoc.md#docx)

### Markdown

我个人非常喜欢 markdown 格式。虽然 markdown 也有缺点，但我认为这就是最完美的格式

  1. 优点
    - 极强的通用性和跨平台性。由于 markdown 直接以文本形式存储数据，不依赖特定的软件，因此可以在几乎所有设备上编辑和查看，包括手表、随身听等。不过要渲染出特定的样式仍然是需要渲染器的。
    - 版本控制友好。这还是因为 markdown 以文本形式存储数据。在 git 里，可以通过 diff 查看不同提交之间的差异，提交记录也不会变得很大。
    - 语法简单。如果你写过 LaTeX，应该会对这一点深有感触的。
    - 完美的源格式。可以通过 Pandoc 等格式转换工具转成 HTML、PDF、PPTX 等适合展示的格式，也可以通过 MkDocs 等静态网站生成器直接生成静态网站。markdown 配合各种工具真正做到了内容和样式的分离，也真正做到了一种形式编写多种形式分发
    - 良好的生态和无限的前景。在 Github 上，markdown 是自述文件（即 README）最推荐使用的格式；而大多数 LLM（包括 DeepSeek、ChatGPT 等）都是直接输出 markdown 的（如果你尝试点击 *复制* 按钮，就会发现剪贴板里内容都是 markdown 格式的文本），且也大多能够理解 markdown 格式的输入
  2. 缺点
    - 没有统一的标准。Github 有 Github 风味的 Markdown，Obsidian 有 Obsidian 风味的 Markdown，Pandoc 也有自己拓展的 Markdown 语法。遇到语法差异较大的情况，文档迁移会有点麻烦。这应该是 Markdown 目前最大的硬伤
    - 排版和样式的功能欠缺。这导致转换为 PDF 等格式会比较麻烦，但通过别的工具可以基本解决这个问题

总之，除了 *没有统一的标准* 这一点外，markdown 的缺点几乎都可以被解决；而 markdown 的优点却是很多别的格式不具备的。我自己编写文档，不管是笔记、报告、架构设计还是 API 规范，几乎都会首先选择 markdown。

当然了，使用 markdown 还是有点门槛的，这也是为什么本文要介绍这么多的文档处理工具。

### PDF

这是一个适合用来展示的格式，对于排版有严格需求的时候常会使用这个格式，比如书籍出版、论文打印等。

### HTML

这也是一个适合展示的格式，但相对更注重内容和样式而不是排版。比如浏览器就使用 HTML 展示内容，在不同大小的屏幕上都能显示得很好。但为了做到这一点也牺牲了一些东西，比如大屏幕的一行可能字很多，而小屏幕得一行字比较少。这种显示得不一致就注定了 HTML 不适合书籍出版这些对排版有严格要求得场合。如果你用过浏览器的打印功能，应该就会发现页边距，尤其是上下的页边距是经常有问题的。

### PPTX

这又是一个适合用来展示的格式。不过我不太喜欢这种格式。

## 工具

### 格式转换

- [Pandoc](Pandoc.md) 文档格式转换工具，支持非常多的格式，包括 Markdown、LaTeX、HTML、PDF、Word、PPTX 等。

### 写作排版

- LaTeX 一种写作排版工具，有很多的发行版。我认为 MikTeX 比 Texlive 更好用一点
- Typst 新一代写作排版工具，简单使用过，语法确实比 LaTeX 简单
